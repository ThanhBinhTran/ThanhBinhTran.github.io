<!DOCTYPE html>
<html>
  <head>
    <title>Thanh-Binh Website</title>
    <!-- (A) JAVASCRIPT -->
    <!-- https://sheetjs.com/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- (A1) STYLES -->
    <link rel="stylesheet" type="text/css" href="styles.css">
    
  </head>
  <body>
    <h3>Computer Architecture course [KIẾN TRÚC MÁY TÍNH (CO2007)_TRẦN THANH BÌNH (CQ_HK222)] V10.14</h3>
    <div>
      <h4>Input student ID code</h4>
      <input type="text" id="searchField" placeholder="Search...">
      <button onclick="search()" class="search-button">Search</button>
    </div>
  


    <!-- (B) FILE PICKER -->
    <input type="file" id="demoA" accept=".xls,.xlsx" />

    <!-- (C) EMPTY TABLE -->
    <h4> Quizes, Exercises, Assignment results:</h4>
    <table id="QEA_result_table" class="styled-table">
      <!-- Table data will be inserted here -->
    </table>

    <!-- (D) JAVASCRIPT TO READ EXCEL FILE & GENERATE HTML TABLE -->
    <script>
      document.getElementById("demoA").onchange = (evt) => {
        // (A) NEW FILE READER
        var reader = new FileReader();

        // (B) ON FINISH LOADING
        reader.addEventListener("loadend", (evt) => {
          // (B1) GET HTML TABLE
          var table = document.getElementById("midterm_result_table");
          table.innerHTML = "";

          // (B2) GET THE FIRST WORKSHEET
          var workbook = XLSX.read(evt.target.result, { type: "binary" }),
            worksheet = workbook.Sheets[workbook.SheetNames[0]],
            range = XLSX.utils.decode_range(worksheet["!ref"]);

          // (B3) READ EXCEL CELLS & INSERT ROWS/COLUMNS
          for (let row = range.s.r; row <= range.e.r; row++) {
            let r = table.insertRow();
            for (let col = range.s.c; col <= range.e.c; col++) {
              let c = r.insertCell(),
                xcell = worksheet[XLSX.utils.encode_cell({ r: row, c: col })];
              c.innerHTML = xcell.v;
            }
          }
        });

        // (C) START - READ SELECTED EXCEL FILE
        reader.readAsArrayBuffer(evt.target.files[0]);
      };
    </script>
  </body>
</html>