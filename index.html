<!DOCTYPE html>
<html>

<head>
  <title>Excel to HTML Table</title>
  <!-- (A) JAVASCRIPT -->
  <!-- https://sheetjs.com/ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
  <!-- (B) FILE PICKER -->
  <input type="file" id="input" accept=".xls,.xlsx" onchange="handleFiles(this.files)">
  
  <button onclick="search()" class="search-button">Search</button>
  <h4> Quizes, exercises, assignment results:</h4>
  <table id="QEA_results" class="styled-table">
    <!-- Table data will be inserted here -->
  </table>

  <script>
    function search() {
      handleFiles("Quiz.xlsx")
    }

    function handleFiles(files) {
      let file = files[0];
      let reader = new FileReader();
      reader.onload = function(e) {
        let data = e.target.result;
        let workbook = XLSX.read(data, {type: 'binary'});
        let sheetName = workbook.SheetNames[0];
        let sheet = workbook.Sheets[sheetName];
        let json = XLSX.utils.sheet_to_json(sheet);
        generateTable(json);
      }
      reader.readAsBinaryString(file);
    }
  
    function generateTable(data) {
      clearTable('QEA_results')
      let table = document.getElementById('QEA_results');
      for (let i = 0; i < data.length; i++) {
        let row = table.insertRow(-1);
        for (let key in data[i]) {
          let cell = row.insertCell(-1);
          cell.innerHTML = data[i][key];
        }
      }
    }

    function clearTable(table_name){
      document.getElementById(table_name).innerHTML = "";
    }
  </script>
</body>

</html>