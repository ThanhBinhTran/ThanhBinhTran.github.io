<!DOCTYPE html>
<html>

<head>
  <title>Thanh-Binh Website</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>
  <h4>Computer Architecture course [KIẾN TRÚC MÁY TÍNH (CO2007)_TRẦN THANH BÌNH (CQ_HK222)] V13.18</h4>
  <div>
    <text>Input student ID code</text>
    <input type="text" id="searchField" placeholder="2110826">
    <button onclick="search()" class="search-button">Search</button>
  </div>

  <h4> OVerall Score results:</h4>
  <table id="1QEA_results" class="styled-table">
    <!-- Table data will be inserted here -->
  </table>

  <h4> Midterm results:</h4>
  <table id="2QEA_results" class="styled-table">
    <!-- Table data will be inserted here -->
  </table>

  <h4> Finalexam:</h4>
  <table id="3QEA_results" class="styled-table">
    <!-- Table data will be inserted here -->
  </table>

  <h4> Quizes, exercises, assignment results:</h4>
  <table id="QEA_results" class="styled-table">
    <!-- Table data will be inserted here -->
  </table>
  <script>
    function search() {
      // Get the search value
      var searchValue = document.getElementById("searchField").value;

      // Read the CSV file
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function () {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          // Parse the CSV data
          var rows = xhr.responseText.split("\n");
          var data = [];
          for (var i = 0; i < rows.length; i++) {
            data.push(rows[i].split(","));
          }

          // Search for matching rows
          var results = [];
          for (var i = 0; i < data.length; i++) {
            for (var j = 0; j < data[i].length; j++) {
              if (data[i][j].includes(searchValue)) {
                results.push(data[i]);
                break;
              }
            }
          }

          // Display the results in a table
          clearTable()
          generateTableHeaders(data[0]);
          insertRow(results);
        }
      }
      xhr.open("GET", "Quiz_CE21.csv", true);
      xhr.send();
    }

    function clearTable(){
      document.getElementById("QEA_results").innerHTML = "";
    }
    function generateTableHeaders(headers) {
      var table = document.getElementById("QEA_results");
      var thead = table.createTHead();
      var row = thead.insertRow();
      for (var i = 0; i < headers.length; i++) {
        var th = document.createElement("th");
        th.innerHTML = headers[i];
        row.appendChild(th);
      }
    }
    function insertRow(rows_data) {
      console.log(rows_data.length);
      console.log(rows_data[0]);
      var table = document.getElementById("QEA_results");
      var row = table.insertRow(-1);
      for (var i = 0; i < rows_data.length; i++) {
        row_items = rows_data[i];
        for (var j =0; j < row_items.length; j++){
          var cell = row.insertCell(i);
          cell.innerHTML = row_items[j];
        }

      }
    }
  </script>
</body>

</html>